#include <iostream>
#include <cmath>
using namespace std;

double calculateTax(double income, bool isMarried) {
    double tax = income;  // wrong, but it will compile...

    if (isMarried) {
        cout << "***MARRIED***" << endl;
    } else {
        cout << "***SINGLE***" << endl;
        if (income <= 10000) {
            tax = income * 0.10;
        } else if (income <= 30000) {
            tax = 1000 + (income - 10000) * 0.15;
        } else if (income <= 70000) {
            tax = 6500 + (income - 30000) * 0.20;
        } else {
          tax = 12000 + (income - 70000) * 0.25;
        }
    }

    return tax;
}

// Bring in unit testing code and tell it to build a main function
#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN
#include "doctest.h"

// The tests
TEST_CASE("calculateTax") {
  CHECK(calculateTax(5000, false) == doctest::Approx(500));
  CHECK(calculateTax(50000, false) == doctest::Approx(8000));
  CHECK(calculateTax(120000, true) == doctest::Approx(21500));
}